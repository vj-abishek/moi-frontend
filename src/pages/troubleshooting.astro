---
import PageLayout from '../layouts/PageLayout.astro';
---

<PageLayout title="Troubleshooting" description="Facing issues with UPI payments? Find solutions to common problems when paying via Moi.">
  <div class="max-w-4xl mx-auto px-6 py-16 md:py-24">
    <!-- Hero -->
    <div class="text-center mb-12">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-warning/10 mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-warning" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z" />
        </svg>
      </div>
      <h1 class="text-4xl md:text-5xl font-bold mb-4">Troubleshooting</h1>
      <p class="text-xl text-base-content/60 max-w-2xl mx-auto">
        Having trouble with UPI payments? Here's how to fix common issues.
      </p>
    </div>

    <!-- Quick Summary Alert -->
    <div class="mb-12 p-6 bg-warning/10 border border-warning/30">
      <div class="flex gap-4">
        <div class="flex-shrink-0">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-warning" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
          </svg>
        </div>
        <div>
          <h3 class="font-bold text-warning mb-1">TL;DR: Payments above â‚¹2,000 failing?</h3>
          <p class="text-base-content/70 text-sm">
            Some UPI apps have a â‚¹2,000 limit when opened via deeplinks. Download the QR code and load it in your UPI app instead, or scan it from another device.
          </p>
        </div>
      </div>
    </div>

    <!-- Issues Section -->
    <div class="space-y-12">
      <!-- The Problem -->
      <section>
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
          <span class="w-8 h-8 bg-error/10 flex items-center justify-center text-error text-sm font-bold">!</span>
          The Problem
        </h2>
        
        <div class="space-y-4">
          <div class="p-6 bg-base-200/50 border border-base-300">
            <h3 class="font-semibold mb-3 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636" />
              </svg>
              UPI App Limits via Deeplinks
            </h3>
            <p class="text-base-content/60 mb-4">
              When you click "Open UPI App" on Moi, we use a <strong>deeplink</strong> to launch your UPI app directly with the payment details pre-filled. However, some apps enforce their own limits when opened this way:
            </p>
            <div class="space-y-3 text-sm">
              <div class="flex items-start gap-3 p-3 bg-base-300/50">
                <span class="w-6 h-6 bg-error/20 text-error flex items-center justify-center text-xs font-bold flex-shrink-0">âœ—</span>
                <div>
                  <span class="font-medium">Some UPI Apps (e.g. Google Pay)</span>
                  <p class="text-base-content/60 mt-1">Client-side validation blocks payments above â‚¹2,000 when opened via deeplink. Trying to pay â‚¹2,001 or more will fail.</p>
                </div>
              </div>
              <div class="flex items-start gap-3 p-3 bg-base-300/50">
                <span class="w-6 h-6 bg-error/20 text-error flex items-center justify-center text-xs font-bold flex-shrink-0">âœ—</span>
                <div>
                  <span class="font-medium">BHIM App</span>
                  <p class="text-base-content/60 mt-1">Won't load the UPI payment interface at all when opened via deeplink - the screen just doesn't appear.</p>
                </div>
              </div>
              <div class="flex items-start gap-3 p-3 bg-base-300/50">
                <span class="w-6 h-6 bg-success/20 text-success flex items-center justify-center text-xs font-bold flex-shrink-0">âœ“</span>
                <div>
                  <span class="font-medium">Paytm</span>
                  <p class="text-base-content/60 mt-1">No limit restrictions via deeplink - works for any amount up to your bank's UPI limit.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Solutions -->
      <section>
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
          <span class="w-8 h-8 bg-success/10 flex items-center justify-center text-success text-sm font-bold">âœ“</span>
          Solutions
        </h2>
        <p class="text-base-content/60 mb-6">
          If you need to pay more than â‚¹2,000, use one of these methods instead:
        </p>

        <div class="grid gap-6 md:grid-cols-2">
          <!-- Solution 1 -->
          <div class="p-6 bg-gradient-to-br from-success/5 to-success/10 border border-success/20">
            <div class="w-12 h-12 bg-success/20 flex items-center justify-center mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-3">Download & Load QR Code</h3>
            <ol class="space-y-2 text-sm text-base-content/70">
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-success/20 text-success flex items-center justify-center text-xs font-bold flex-shrink-0">1</span>
                <span>Download the QR code from the payment screen</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-success/20 text-success flex items-center justify-center text-xs font-bold flex-shrink-0">2</span>
                <span>Open your UPI app (GPay, PhonePe, Paytm, etc.)</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-success/20 text-success flex items-center justify-center text-xs font-bold flex-shrink-0">3</span>
                <span>Look for "Scan QR" or "Load from Gallery" option</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-success/20 text-success flex items-center justify-center text-xs font-bold flex-shrink-0">4</span>
                <span>Select the downloaded QR image</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-success/20 text-success flex items-center justify-center text-xs font-bold flex-shrink-0">5</span>
                <span>Complete the payment - your bank's daily limit applies</span>
              </li>
            </ol>
            <p class="mt-4 text-xs text-base-content/50">
              ðŸ’¡ All major UPI apps support loading QR from gallery
            </p>
          </div>

          <!-- Solution 2 -->
          <div class="p-6 bg-gradient-to-br from-primary/5 to-primary/10 border border-primary/20">
            <div class="w-12 h-12 bg-primary/20 flex items-center justify-center mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-3">Scan from Another Device</h3>
            <ol class="space-y-2 text-sm text-base-content/70">
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-primary/20 text-primary flex items-center justify-center text-xs font-bold flex-shrink-0">1</span>
                <span>Open the payment page on a laptop or another phone</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-primary/20 text-primary flex items-center justify-center text-xs font-bold flex-shrink-0">2</span>
                <span>Display the QR code on that screen</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-primary/20 text-primary flex items-center justify-center text-xs font-bold flex-shrink-0">3</span>
                <span>Use your phone's UPI app camera to scan the QR</span>
              </li>
              <li class="flex gap-2">
                <span class="w-5 h-5 bg-primary/20 text-primary flex items-center justify-center text-xs font-bold flex-shrink-0">4</span>
                <span>Complete the payment normally</span>
              </li>
            </ol>
            <p class="mt-4 text-xs text-base-content/50">
              ðŸ’¡ This is how QR payments are meant to work - no app restrictions
            </p>
          </div>
        </div>
      </section>

      <!-- Why This Happens -->
      <section>
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
          <span class="w-8 h-8 bg-info/10 flex items-center justify-center text-info text-sm font-bold">?</span>
          Why Does This Happen?
        </h2>
        
        <details class="group bg-base-200/50 border border-base-300 mb-4">
          <summary class="cursor-pointer p-4 font-medium flex items-center justify-between">
            Technical explanation
            <svg class="w-5 h-5 text-base-content/40 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <div class="px-4 pb-4 text-base-content/60 space-y-3">
            <p>
              Some UPI apps add their own <strong>client-side validation</strong> when payments are initiated through deeplinks (upi:// URLs). This is a security measure they've implemented to prevent fraud from malicious apps. BHIM app doesn't support deeplinks at all.
            </p>
            <p>
              When you scan a QR code directly using the app's camera or load a QR from your gallery, these restrictions don't apply - your bank's actual UPI limit (usually â‚¹1,00,000/day) is what matters.
            </p>
            <p>
              This isn't a Moi limitation - it's how these UPI apps work. Paytm doesn't have this restriction, which is why it works for any amount via deeplink.
            </p>
          </div>
        </details>
      </section>

      <!-- UPI Limits Reference -->
      <section>
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
          <span class="w-8 h-8 bg-secondary/10 flex items-center justify-center text-secondary text-sm font-bold">â‚¹</span>
          UPI Limits Reference
        </h2>
        
        <div class="overflow-x-auto">
          <table class="w-full text-sm">
            <thead>
              <tr class="border-b border-base-300">
                <th class="text-left py-3 px-4 font-semibold">Method</th>
                <th class="text-left py-3 px-4 font-semibold">Limit</th>
                <th class="text-left py-3 px-4 font-semibold">Notes</th>
              </tr>
            </thead>
            <tbody>
              <tr class="border-b border-base-300/50">
                <td class="py-3 px-4 font-medium">Deeplink (e.g. GPay)</td>
                <td class="py-3 px-4 text-error">â‚¹2,000</td>
                <td class="py-3 px-4 text-base-content/60">App-enforced limit</td>
              </tr>
              <tr class="border-b border-base-300/50">
                <td class="py-3 px-4 font-medium">Deeplink (BHIM)</td>
                <td class="py-3 px-4 text-error">Doesn't work</td>
                <td class="py-3 px-4 text-base-content/60">Won't load at all</td>
              </tr>
              <tr class="border-b border-base-300/50">
                <td class="py-3 px-4 font-medium">Deeplink (Paytm)</td>
                <td class="py-3 px-4 text-success">Bank limit</td>
                <td class="py-3 px-4 text-base-content/60">No app restriction</td>
              </tr>
              <tr class="border-b border-base-300/50">
                <td class="py-3 px-4 font-medium">Scan QR / Load from Gallery</td>
                <td class="py-3 px-4 text-success">Bank limit</td>
                <td class="py-3 px-4 text-base-content/60">Usually â‚¹1,00,000/day</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- Still have issues? -->
    <div class="mt-16 p-8 bg-gradient-to-r from-primary/5 to-secondary/5 border border-base-300 text-center">
      <h2 class="text-2xl font-bold mb-2">Still facing issues?</h2>
      <p class="text-base-content/60 mb-6">
        If the solutions above didn't work, reach out and we'll help you out.
      </p>
      <a href="/support" class="inline-flex items-center gap-2 px-8 py-4 bg-primary text-primary-content text-sm uppercase tracking-widest font-semibold hover:bg-primary/90 transition-all">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z" />
        </svg>
        Contact Support
      </a>
    </div>
  </div>
</PageLayout>

